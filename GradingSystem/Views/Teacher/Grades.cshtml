@{
    Layout = "~/Views/Shared/_TeacherLayout.cshtml";
    ViewData["Title"] = "Manage Grades";
}

<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold">Grade Management</h2>

        <div class="d-flex gap-2">
            <select class="form-select" style="width: 220px;">
                <option selected>Select Subject</option>
                <option value="CS101">CS101 - Intro to Programming</option>
                <option value="CS202">CS202 - Database Systems</option>
                <option value="CS305">CS305 - Web Development</option>
            </select>

            <button class="btn btn-primary">
                <i data-lucide="search"></i> Load Students
            </button>
        </div>
    </div>

    <!-- Grades Table -->
    <div class="card shadow-sm border-0">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">Student Grades</h5>
        </div>

        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-striped table-hover align-middle mb-0">
                    <thead class="table-light">
                        <tr>
                            <th>#</th>
                            <th>Student ID</th>
                            <th>Student Name</th>
                            <th>Prelim</th>
                            <th>Midterm</th>
                            <th>Final</th>
                            <th>Average</th>
                            <th>Remarks</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>2025-001</td>
                            <td>Juan Dela Cruz</td>
                            <td><input type="number" class="form-control form-control-sm" value="88" /></td>
                            <td><input type="number" class="form-control form-control-sm" value="85" /></td>
                            <td><input type="number" class="form-control form-control-sm" value="90" /></td>
                            <td><span class="fw-bold text-success">87.6</span></td>
                            <td>Passed</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>2025-002</td>
                            <td>Maria Santos</td>
                            <td><input type="number" class="form-control form-control-sm" value="75" /></td>
                            <td><input type="number" class="form-control form-control-sm" value="79" /></td>
                            <td><input type="number" class="form-control form-control-sm" value="81" /></td>
                            <td><span class="fw-bold text-warning">78.3</span></td>
                            <td>Passed</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>2025-003</td>
                            <td>Carlos Ramos</td>
                            <td><input type="number" class="form-control form-control-sm" value="64" /></td>
                            <td><input type="number" class="form-control form-control-sm" value="70" /></td>
                            <td><input type="number" class="form-control form-control-sm" value="68" /></td>
                            <td><span class="fw-bold text-danger">67.3</span></td>
                            <td>Failed</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="card-footer text-end">
            <button class="btn btn-success">
                <i data-lucide="save"></i> Save Grades
            </button>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        lucide.createIcons();

        // Optional: auto-calculate average when grades change
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('input', () => {
                const row = input.closest('tr');
                const prelim = parseFloat(row.children[3].querySelector('input').value) || 0;
                const midterm = parseFloat(row.children[4].querySelector('input').value) || 0;
                const final = parseFloat(row.children[5].querySelector('input').value) || 0;
                const average = ((prelim + midterm + final) / 3).toFixed(1);

                row.children[6].innerHTML = `<span class="fw-bold ${average >= 75 ? 'text-success' : 'text-danger'}">${average}</span>`;
                row.children[7].innerText = average >= 75 ? 'Passed' : 'Failed';
            });
        });
    </script>
}
